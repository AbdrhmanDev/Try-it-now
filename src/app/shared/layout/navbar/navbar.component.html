<!-- Creative Topics Navbar -->
<nav
  class="navbar fixed top-0 left-0 right-0 z-50 transition-all duration-500 ease-out"
  [class.scrolled]="isScrolled()"
  [class.menu-open]="isMenuOpen()"
>
  <!-- Navbar Container -->
  <div class="navbar-container max-w-8xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="flex items-center justify-between h-16">
      <!-- Logo & Brand -->
      <div class="flex items-center space-x-4">
        <a
          routerLink="/"
          class="logo-brand flex items-center space-x-3 group"
          (click)="closeAllMenus()"
        >
          <!-- Animated Logo -->
          <div class="logo-container relative">
            <div
              class="logo-icon w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center shadow-lg group-hover:shadow-blue-500/25 transition-all duration-300"
            >
              <i
                class="fab fa-angular text-white text-lg group-hover:rotate-180 transition-transform duration-500"
              ></i>
            </div>
            <div
              class="absolute -top-1 -right-1 w-3 h-3 bg-gradient-to-r from-orange-400 to-pink-500 rounded-full animate-pulse"
            ></div>
          </div>

          <!-- Brand Text -->
          <div class="brand-text hidden sm:block">
            <h1
              class="text-xl font-bold bg-gradient-to-r from-white to-gray-300 bg-clip-text text-transparent"
            >
              Angular<span class="text-blue-400">Hub</span>
            </h1>
            <p class="text-xs text-gray-400 -mt-1">Learn • Build • Excel</p>
          </div>
        </a>
      </div>

      <!-- Desktop Navigation -->
      <div class="hidden lg:flex items-center space-x-1">
        @for (item of navItems(); track item.path) { @if (item.isMegaMenu) {
        <!-- Topics Mega Menu Trigger -->
        <div class="relative">
          <button
            type="button"
            class="nav-link px-4 py-2 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 transition-all duration-200 flex items-center space-x-2 group"
            (click)="toggleMegaMenu()"
            [class.active]="isMegaMenuOpen()"
          >
            <i
              [class]="item.icon"
              class="text-sm group-hover:scale-110 transition-transform duration-200"
            ></i>
            <span class="font-medium">{{ item.label }}</span>
            <i
              class="fas fa-chevron-down text-xs transition-transform duration-200"
              [class.rotate-180]="isMegaMenuOpen()"
            ></i>
          </button>
        </div>
        } @else {
        <!-- Regular Navigation Link -->
        <a
          [routerLink]="item.path"
          routerLinkActive="active"
          [routerLinkActiveOptions]="{ exact: item.path === '/' }"
          class="nav-link px-4 py-2 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 transition-all duration-200 flex items-center space-x-2 group"
          [title]="item.description"
          (click)="closeAllMenus()"
        >
          <i
            [class]="item.icon"
            class="text-sm group-hover:scale-110 transition-transform duration-200"
          ></i>
          <span class="font-medium">{{ item.label }}</span>
        </a>
        } }
      </div>

      <!-- Search & Auth -->
      <div class="hidden lg:flex items-center space-x-4">
        <!-- Search Bar -->
        <div class="relative">
          <div
            class="search-container relative"
            [class.focused]="isSearchFocused()"
          >
            <input
              type="text"
              placeholder="Search topics..."
              class="search-input w-64 pl-10 pr-4 py-2 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500/50 focus:border-blue-500/50 transition-all duration-200"
              [(ngModel)]="searchQuery"
              (focus)="onSearchFocus()"
              (blur)="onSearchBlur()"
            />
            <i
              class="fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"
            ></i>
          </div>
        </div>

        <!-- Auth Buttons -->
        @if (!authService.isLoggedIn()) {
        <button
          routerLink="/login"
          class="auth-btn login-btn px-4 py-2 text-gray-300 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-200 font-medium"
        >
          Sign In
        </button>
        <button
          routerLink="/register"
          class="auth-btn signup-btn px-6 py-2 bg-gradient-to-r from-blue-500 to-purple-600 hover:from-blue-600 hover:to-purple-700 text-white font-semibold rounded-lg shadow-lg hover:shadow-blue-500/25 transition-all duration-200 transform hover:scale-105"
        >
          Get Started
        </button>
        } @else {
        <!-- User Menu -->
        <div class="user-menu relative">
          <button
            class="user-avatar w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold shadow-lg hover:shadow-blue-500/25 transition-all duration-200"
          >
            {{ currentUser?.name?.charAt(0) || "U" }}
          </button>
        </div>
        }
      </div>

      <!-- Mobile Menu Button -->
      <button
        class="lg:hidden mobile-menu-btn relative w-10 h-10 rounded-lg bg-white/10 hover:bg-white/20 transition-all duration-200 flex items-center justify-center"
        (click)="toggleMenu()"
        [class.active]="isMenuOpen()"
      >
        <div class="hamburger">
          <span
            class="line line-1 block w-5 h-0.5 bg-white mb-1 transition-all duration-300"
          ></span>
          <span
            class="line line-2 block w-5 h-0.5 bg-white mb-1 transition-all duration-300"
          ></span>
          <span
            class="line line-3 block w-5 h-0.5 bg-white transition-all duration-300"
          ></span>
        </div>
      </button>
    </div>
  </div>

  <!-- Topics Mega Menu -->
  @if (isMegaMenuOpen()) {
  <div
    class="mega-menu absolute top-full left-0 right-0 bg-slate-900/95 backdrop-blur-lg border-t border-white/10 shadow-2xl"
  >
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8">
        @for (category of topicsCategories(); track category.title) {
        <div class="topic-category">
          <!-- Category Header -->
          <div
            class="category-header flex items-center space-x-3 mb-4 pb-3 border-b border-white/10"
          >
            <div
              class="category-icon w-8 h-8 rounded-lg bg-gradient-to-br {{
                category.color
              }} flex items-center justify-center"
            >
              <i [class]="category.icon" class="text-white text-sm"></i>
            </div>
            <h3 class="text-lg font-semibold text-white">
              {{ category.title }}
            </h3>
          </div>

          <!-- Category Topics -->
          <div class="topic-links space-y-2">
            @for (topic of category.topics; track topic.path) {
            <a
              [routerLink]="topic.path"
              class="topic-link block p-3 rounded-lg hover:bg-white/10 transition-all duration-200 group cursor-pointer"
              (click)="closeAllMenus()"
            >
              <div class="flex items-start justify-between">
                <div class="flex-1">
                  <div class="flex items-center space-x-2 mb-1">
                    <h4
                      class="text-sm font-medium text-white group-hover:text-blue-400 transition-colors duration-200"
                    >
                      {{ topic.label }}
                    </h4>
                    @if (topic.isNew) {
                    <span
                      class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-green-500/20 text-green-400"
                    >
                      New
                    </span>
                    } @if (topic.isPopular) {
                    <span
                      class="inline-flex items-center px-2 py-0.5 rounded text-xs font-medium bg-orange-500/20 text-orange-400"
                    >
                      Popular
                    </span>
                    }
                  </div>
                  <p class="text-xs text-gray-400 leading-relaxed">
                    {{ topic.description }}
                  </p>
                  <div class="mt-2 flex items-center space-x-2">
                    <span
                      class="text-xs {{
                        getDifficultyColor(topic.difficulty)
                      }} font-medium"
                    >
                      {{ topic.difficulty }}
                    </span>
                  </div>
                </div>
                <i
                  class="fas fa-arrow-right text-gray-600 group-hover:text-blue-400 group-hover:translate-x-1 transition-all duration-200"
                ></i>
              </div>
            </a>
            }
          </div>
        </div>
        }
      </div>

      <!-- Quick Stats -->
      <div class="mt-8 pt-6 border-t border-white/10">
        <div class="flex items-center justify-between">
          <div class="flex items-center space-x-6 text-sm text-gray-400">
            <span><i class="fas fa-book-open mr-2"></i>50+ Topics</span>
            <span><i class="fas fa-code mr-2"></i>200+ Examples</span>
            <span><i class="fas fa-users mr-2"></i>10k+ Learners</span>
          </div>
          <a
            routerLink="/topics"
            class="text-blue-400 hover:text-blue-300 font-medium text-sm transition-colors duration-200"
            (click)="closeAllMenus()"
          >
            View All Topics <i class="fas fa-arrow-right ml-1"></i>
          </a>
        </div>
      </div>
    </div>
  </div>
  }

  <!-- Mobile Menu Overlay -->
  @if (isMenuOpen()) {
  <div
    class="mobile-overlay fixed inset-0 bg-black/60 backdrop-blur-sm lg:hidden"
  >
    <!-- Mobile Menu Panel -->
    <div
      class="mobile-menu fixed top-0 right-0 h-full w-80 max-w-sm bg-slate-900 shadow-2xl transform transition-transform duration-300 ease-out"
    >
      <div class="flex flex-col h-full">
        <!-- Mobile Header -->
        <div
          class="mobile-header flex items-center justify-between p-6 border-b border-white/10"
        >
          <div class="flex items-center space-x-3">
            <div
              class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center"
            >
              <i class="fab fa-angular text-white"></i>
            </div>
            <span class="text-lg font-bold text-white">AngularHub</span>
          </div>
          <button
            class="close-btn w-8 h-8 rounded-lg bg-white/10 hover:bg-white/20 flex items-center justify-center transition-colors duration-200"
            (click)="closeAllMenus()"
          >
            <i class="fas fa-times text-white"></i>
          </button>
        </div>

        <!-- Mobile Navigation -->
        <div class="mobile-nav flex-1 overflow-y-auto p-6">
          <div class="space-y-2">
            @for (item of navItems(); track item.path) { @if (item.isMegaMenu) {
            <!-- Mobile Topics Menu -->
            <div class="mobile-mega-menu">
              <button
                class="mobile-nav-link w-full flex items-center justify-between p-3 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 transition-all duration-200"
                (click)="
                  setActiveSubmenu(
                    activeSubmenu() === 'topics' ? null : 'topics'
                  )
                "
              >
                <div class="flex items-center space-x-3">
                  <i [class]="item.icon" class="text-blue-400"></i>
                  <span class="font-medium">{{ item.label }}</span>
                </div>
                <i
                  class="fas fa-chevron-down transition-transform duration-200"
                  [class.rotate-180]="activeSubmenu() === 'topics'"
                ></i>
              </button>

              @if (activeSubmenu() === 'topics') {
              <div
                class="mobile-submenu mt-2 ml-4 space-y-3 border-l-2 border-blue-500/30 pl-4"
              >
                @for (category of topicsCategories(); track category.title) {
                <div class="mobile-category">
                  <h4
                    class="text-sm font-semibold text-gray-400 mb-2 flex items-center space-x-2"
                  >
                    <i [class]="category.icon" class="text-xs"></i>
                    <span>{{ category.title }}</span>
                  </h4>
                  <div class="space-y-1">
                    @for (topic of category.topics.slice(0, 3); track
                    topic.path) {
                    <a
                      [routerLink]="topic.path"
                      class="block p-2 rounded text-sm text-gray-300 hover:text-white hover:bg-white/10 transition-colors duration-200"
                      (click)="closeAllMenus()"
                    >
                      {{ topic.label }}
                    </a>
                    }
                  </div>
                </div>
                }
              </div>
              }
            </div>
            } @else {
            <!-- Regular Mobile Link -->
            <a
              [routerLink]="item.path"
              routerLinkActive="active"
              [routerLinkActiveOptions]="{ exact: item.path === '/' }"
              class="mobile-nav-link flex items-center space-x-3 p-3 rounded-lg text-gray-300 hover:text-white hover:bg-white/10 transition-all duration-200"
              (click)="closeAllMenus()"
            >
              <i [class]="item.icon" class="text-blue-400"></i>
              <span class="font-medium">{{ item.label }}</span>
            </a>
            } }
          </div>
        </div>

        <!-- Mobile Auth -->
        <div class="mobile-auth p-6 border-t border-white/10">
          @if (!authService.isLoggedIn()) {
          <div class="space-y-3">
            <button
              routerLink="/login"
              class="w-full py-3 text-gray-300 hover:text-white hover:bg-white/10 rounded-lg transition-all duration-200 font-medium border border-white/20"
              (click)="closeAllMenus()"
            >
              Sign In
            </button>
            <button
              routerLink="/register"
              class="w-full py-3 bg-gradient-to-r from-blue-500 to-purple-600 text-white font-semibold rounded-lg shadow-lg transition-all duration-200"
              (click)="closeAllMenus()"
            >
              Get Started Free
            </button>
          </div>
          } @else {
          <div class="space-y-3">
            <div class="flex items-center space-x-3 p-3 rounded-lg bg-white/10">
              <div
                class="w-8 h-8 rounded-lg bg-gradient-to-br from-blue-500 to-purple-600 flex items-center justify-center text-white font-semibold"
              >
                {{ currentUser?.name?.charAt(0) || "U" }}
              </div>
              <span class="text-white font-medium">{{
                currentUser?.name || "User"
              }}</span>
            </div>
            <button
              class="w-full py-3 text-red-400 hover:bg-red-500/10 rounded-lg transition-all duration-200 font-medium"
              (click)="logout()"
            >
              Sign Out
            </button>
          </div>
          }
        </div>
      </div>
    </div>
  </div>
  }
</nav>
